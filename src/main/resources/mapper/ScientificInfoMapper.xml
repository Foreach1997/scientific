<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ts.scientific.mapper.ScientificInfoMapper">


    <select id="queryAllScientificInfo" resultType="com.ts.scientific.dto.StatisticsInfoDto" parameterType="com.ts.scientific.vo.StatisticsInfoVO">
        SELECT u.dep_name as 'depName' , u.user_name as 'userName',
        a.*,
        b.calculate_score AS calculateScore,
        b.calculate_condition AS calculateCondition
        FROM scientific_info as a JOIN scientific_info_conf b ON a.project_type_id = b.project_type_id
        <if test="projectTypeName != null and projectTypeName != ''">
            AND    a.project_type_name = #{projectTypeName}
        </if>
        <if test="rule != null and rule != ''">
            AND    a.rule LIKE concat("%",#{rule},"%")
        </if>
        ORDER BY a.project_type_id DESC

        LIMIT page,limit
    </select>

    <select id="count"  parameterType="com.ts.scientific.vo.StatisticsInfoVO">
        SELECT count(project_type_id)
        FROM scientific_info as a JOIN scientific_info_conf b ON a.project_type_id = b.project_type_id
        <if test="projectTypeName != null and projectTypeName != ''">
            AND    a.project_type_name = #{projectTypeName}
        </if>
        <if test="rule != null and rule != ''">
            AND    a.rule LIKE concat("%",#{rule},"%")
        </if>
    </select>


</mapper>
